---
description:
globs:
alwaysApply: true
---

# セキュリティ規約

## 認証・認可

- JWT トークンベースの認証を使用
- トークンは httpOnly Cookie または Authorization ヘッダーで送信
- リフレッシュトークンの実装
- RBAC（Role-Based Access Control）による認可

## 環境変数管理

- 機密情報は必ず環境変数で管理
- `.env` ファイルは `.gitignore` に追加
- `.env.example` ファイルでテンプレートを提供
- 本番環境では環境変数を適切に設定

## データベースセキュリティ

- SQL インジェクション対策: SQLAlchemy ORM を使用
- パスワードは必ずハッシュ化（bcrypt 推奨）
- データベース接続文字列は環境変数で管理

## API セキュリティ

- CORS 設定の適切な構成
- レート制限の実装
- 入力バリデーション（Pydantic スキーマ）
- エラーメッセージで機密情報を漏らさない

## フロントエンドセキュリティ

- XSS 対策: React のデフォルト エスケープを活用
- CSRF 対策: トークンベース認証
- 機密情報をクライアントサイドに保存しない
- Content Security Policy (CSP) の設定

## 依存関係管理

- 定期的な依存関係の更新
- 脆弱性スキャンツールの使用（npm audit, pip-audit）
- セキュリティアラートへの迅速な対応

## ログとモニタリング

- 機密情報（パスワード、トークン）をログに出力しない
- 認証・認可の失敗をログに記録
- 異常なアクセスパターンの監視
